name: Discord Notifications

on:
  push:
    branches: [ "main" ]
  pull_request:
    types: [opened, reopened, synchronize, closed]

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      # PUSH â†’ link a commitre
      - name: Discord (push)
        if: ${{ github.event_name == 'push' }}
        uses: Ilshidur/action-discord@master
        with:
          webhook: ${{ secrets.DISCORD_WEBHOOK_URL }}
          args: |
            ðŸš€ **Push to `${{ github.ref_name }}`**
            â€¢ Repo: **${{ github.repository }}**
            â€¢ Author: **${{ github.actor }}**
            â€¢ Commit: `${{ github.sha }}`
            ðŸ‘‰ https://github.com/${{ github.repository }}/commit/${{ github.sha }}

      # PR OPEN/UPDATE â†’ link a PR-re
      - name: Discord (PR opened/reopened/sync)
        if: ${{ github.event_name == 'pull_request' && github.event.action != 'closed' }}
        uses: Ilshidur/action-discord@master
        with:
          webhook: ${{ secrets.DISCORD_WEBHOOK_URL }}
          args: |
            ðŸ”€ **PR #${{ github.event.pull_request.number }} â€” ${{ github.event.pull_request.title }}**
            â€¢ Repo: **${{ github.repository }}**
            â€¢ Author: **${{ github.actor }}**
            â€¢ State: **${{ github.event.action }}**
            ðŸ‘‰ ${{ github.event.pull_request.html_url }}

      # PR MERGE â†’ kÃ¼lÃ¶n jelzÃ©s
      - name: Discord (PR merged)
        if: ${{ github.event_name == 'pull_request' && github.event.action == 'closed' && github.event.pull_request.merged == true }}
        uses: Ilshidur/action-discord@master
        with:
          webhook: ${{ secrets.DISCORD_WEBHOOK_URL }}
          args: |
            âœ… **PR merged!**  #${{ github.event.pull_request.number }} â€” ${{ github.event.pull_request.title }}
            â€¢ Repo: **${{ github.repository }}**
            â€¢ Merged by: **${{ github.actor }}**
            ðŸ‘‰ ${{ github.event.pull_request.html_url }}

      # PR CLOSED (nem merge) â†’ kÃ¼lÃ¶n jelzÃ©s
      - name: Discord (PR closed without merge)
        if: ${{ github.event_name == 'pull_request' && github.event.action == 'closed' && github.event.pull_request.merged != true }}
        uses: Ilshidur/action-discord@master
        with:
          webhook: ${{ secrets.DISCORD_WEBHOOK_URL }}
          args: |
            ðŸš« **PR closed (not merged)**  #${{ github.event.pull_request.number }} â€” ${{ github.event.pull_request.title }}
            â€¢ Repo: **${{ github.repository }}**
            â€¢ Closed by: **${{ github.actor }}**
            ðŸ‘‰ ${{ github.event.pull_request.html_url }}
